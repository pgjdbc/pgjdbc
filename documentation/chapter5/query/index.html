<!doctype html><html><head><meta charset=utf-8><title>Pgjdbc | Issuing a Query and Processing the Result</title><link rel=stylesheet href=https://pgjdbc.github.io/pgjdbc/sass/main.e946902265096118ab63cb74d4453d2690cb98e02350ac6ad40325a645b55613.css integrity="sha256-6UaQImUJYRirY8t01EU9JpDLmOAjUKxq1AMlpkW1VhM="><link rel=icon href=favicon.ico type=image/x-icon><link rel="shortcut icon" href=favicon.ico type=image/x-icon></head><body><nav class=nav><a href=/pgjdbc><img src=/images/postgreslogo.svg></a><div class=nav__items><a class=nav__item href=/pgjdbc/development/>Development</a>
<a class=nav__item href=/pgjdbc/download/>Download</a>
<a class=nav__item href=/pgjdbc/documentation/>Documentation</a>
<a class=nav__item href=/pgjdbc/community/>Community</a></div><a href=https://github.com/pgjdbc/pgjdbc><img src=/images/github.svg></a></nav><main><div class=flex><nav role=navigation class=side__nav><ul><li><a href=/pgjdbc/documentation/chapter1/>Introduction</a><ul><li><a href=/pgjdbc/documentation/chapter1/intro/>Introduction</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter2/>Setting up the JDBC Driver</a><ul><li><a href=/pgjdbc/documentation/chapter2/setup/>Getting the Driver</a></li><li><a href=/pgjdbc/documentation/chapter2/classpath/>Setting up the Class Path</a></li><li><a href=/pgjdbc/documentation/chapter2/prepare/>Preparing the Database Server for JDBC</a></li><li><a href=/pgjdbc/documentation/chapter2/your-database/>Creating a Database</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter3/>Initializing the Driver</a><ul><li><a href=/pgjdbc/documentation/chapter3/use/>Importing JDBC</a></li><li><a href=/pgjdbc/documentation/chapter3/load/>Loading the Driver</a></li><li><a href=/pgjdbc/documentation/chapter3/connect/>Connecting to the Database</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter4/>Using SSL</a><ul><li><a href=/pgjdbc/documentation/chapter4/ssl/>Configuring the Server</a></li><li><a href=/pgjdbc/documentation/chapter4/ssl-client/>Configuring the Client</a></li><li><a href=/pgjdbc/documentation/chapter4/ssl-factory/>Custom SSLSocketFactory</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter5/>Issuing a Query and Processing the Result</a><ul><li><a href=/pgjdbc/documentation/chapter5/query/>Issuing a Query and Processing the Result</a></li><li><a href=/pgjdbc/documentation/chapter5/statement/>Using the Statement or PreparedStatement Interface</a></li><li><a href=/pgjdbc/documentation/chapter5/resultset/>Using the ResultSet Interface</a></li><li><a href=/pgjdbc/documentation/chapter5/update/>Performing Updates</a></li><li><a href=/pgjdbc/documentation/chapter5/ddl/>Creating and Modifying Database Objects</a></li><li><a href=/pgjdbc/documentation/chapter5/java8-date-time/>Using Java 8 Date and Time classes</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter6/>Calling Stored Functions and Procedures</a><ul><li><a href=/pgjdbc/documentation/chapter6/callproc/>Calling Stored Functions and Procedures</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter7/>Storing Binary Data</a><ul><li><a href=/pgjdbc/documentation/chapter7/binary-data/>Storing Binary Data</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter8/>JDBC escapes</a><ul><li><a href=/pgjdbc/documentation/chapter8/escapes/>JDBC escapes</a></li><li><a href=/pgjdbc/documentation/chapter8/outer-joins-escape/>Escape for outer joins</a></li><li><a href=/pgjdbc/documentation/chapter8/escapes-datetime/>Date-time escapes</a></li><li><a href=/pgjdbc/documentation/chapter8/escaped-functions/>Escaped scalar functions</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter9/>PostgreSQL™ Extensions to the JDBC API</a><ul><li><a href=/pgjdbc/documentation/chapter9/ext/>PostgreSQL™ Extensions to the JDBC API</a></li><li><a href=/pgjdbc/documentation/chapter9/geometric/>Geometric Data Types</a></li><li><a href=/pgjdbc/documentation/chapter9/largeobjects/>Large Objects</a></li><li><a href=/pgjdbc/documentation/chapter9/listennotify/>Listen / Notify</a></li><li><a href=/pgjdbc/documentation/chapter9/server-prepare/>Server Prepared Statements</a></li><li><a href=/pgjdbc/documentation/chapter9/parameterstatus/>Parameter Status Messages</a></li><li><a href=/pgjdbc/documentation/chapter9/replication/>Physical and Logical replication API</a></li><li><a href=/pgjdbc/documentation/chapter9/arrays/>Arrays</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter10/>Using the Driver in a Multithreaded or a Servlet Environment</a><ul><li><a href=/pgjdbc/documentation/chapter10/thread/>Using the Driver in a Multithreaded or a Servlet Environment</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter11/>Connection Pools and Data Sources</a><ul><li><a href=/pgjdbc/documentation/chapter11/datasource/>Connection Pools and Data Sources</a></li><li><a href=/pgjdbc/documentation/chapter11/ds-cpds/>Application Servers ConnectionPoolDataSource</a></li><li><a href=/pgjdbc/documentation/chapter11/ds-ds/>Applications DataSource</a></li><li><a href=/pgjdbc/documentation/chapter11/jndi/>Data Sources and JNDI</a></li><li><a href=/pgjdbc/documentation/chapter11/tomcat/>Tomcat setup</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter12/>Logging using java.util.logging</a><ul><li><a href=/pgjdbc/documentation/chapter12/logging/>Logging using java.util.logging</a></li></ul></li><li><a href=/pgjdbc/documentation/chapter13/>Further Reading</a><ul><li><a href=/pgjdbc/documentation/chapter13/reading/>Further Reading</a></li></ul></li></ul></nav><article><h1>Issuing a Query and Processing the Result</h1><br><p>Any time you want to issue SQL statements to the database, you require a <code>Statement</code>
or <code>PreparedStatement</code> instance. Once you have a <code>Statement</code> or <code>PreparedStatement</code>,
you can use issue a query. This will return a <code>ResultSet</code> instance, which contains
the entire result (see the section called <a href=query.html#query-with-cursor>“Getting results based on a cursor”</a>
here for how to alter this behaviour). <a href=query.html#query-example>Example 5.1, “Processing a Simple Query in JDBC”</a>
illustrates this process.</p><p><strong>Example 5.1. Processing a Simple Query in JDBC</strong></p><p>This example will issue a simple query and print out the first column of each
row using a <code>Statement</code>.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>Statement</span> <span class=n>st</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=na>createStatement</span><span class=o>();</span>
<span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=s>&#34;SELECT * FROM mytable WHERE columnfoo = 500&#34;</span><span class=o>);</span>
<span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>())</span>
<span class=o>{</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;Column 1 returned &#34;</span><span class=o>);</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>1</span><span class=o>));</span>
<span class=o>}</span>
<span class=n>rs</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
<span class=n>st</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</code></pre></div><p>This example issues the same query as before but uses a <code>PreparedStatement</code> and
a bind value in the query.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kt>int</span> <span class=n>foovalue</span> <span class=o>=</span> <span class=n>500</span><span class=o>;</span>
<span class=n>PreparedStatement</span> <span class=n>st</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=na>prepareStatement</span><span class=o>(</span><span class=s>&#34;SELECT * FROM mytable WHERE columnfoo = ?&#34;</span><span class=o>);</span>
<span class=n>st</span><span class=o>.</span><span class=na>setInt</span><span class=o>(</span><span class=n>1</span><span class=o>,</span> <span class=n>foovalue</span><span class=o>);</span>
<span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>();</span>
<span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>())</span>
<span class=o>{</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;Column 1 returned &#34;</span><span class=o>);</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>1</span><span class=o>));</span>
<span class=o>}</span>
<span class=n>rs</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
<span class=n>st</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</code></pre></div><h1 id=getting-results-based-on-a-cursor>Getting results based on a cursor</h1><p>By default the driver collects all the results for the query at once. This can
be inconvenient for large data sets so the JDBC driver provides a means of basing
a <code>ResultSet</code> on a database cursor and only fetching a small number of rows.</p><p>A small number of rows are cached on the client side of the connection and when
exhausted the next block of rows is retrieved by repositioning the cursor.</p><h3 id=note>Note</h3><blockquote><p>Cursor based <code>ResultSets</code> cannot be used in all situations. There a number of
restrictions which will make the driver silently fall back to fetching the
whole <code>ResultSet</code> at once.</p></blockquote><ul><li>The connection to the server must be using the V3 protocol. This is the default
for (and is only supported by) server versions 7.4 and later.</li><li>The <code>Connection</code> must not be in autocommit mode. The backend closes cursors at
the end of transactions, so in autocommit mode the backend will have
closed the cursor before anything can be fetched from it.</li><li>The <code>Statement</code> must be created with a <code>ResultSet</code> type of <code>ResultSet.TYPE_FORWARD_ONLY</code>.
This is the default, so no code will need to be rewritten to take advantage
of this, but it also means that you cannot scroll backwards or otherwise
jump around in the <code>ResultSet</code>.</li><li>The query given must be a single statement, not multiple statements strung
together with semicolons.</li></ul><p><strong>Example 5.2. Setting fetch size to turn cursors on and off.</strong></p><p>Changing code to cursor mode is as simple as setting the fetch size of the
<code>Statement</code> to the appropriate size. Setting the fetch size back to 0 will cause
all rows to be cached (the default behaviour).</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=c1>// make sure autocommit is off
</span><span class=c1></span><span class=n>conn</span><span class=o>.</span><span class=na>setAutoCommit</span><span class=o>(</span><span class=kc>false</span><span class=o>);</span>
<span class=n>Statement</span> <span class=n>st</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=na>createStatement</span><span class=o>();</span>

<span class=c1>// Turn use of the cursor on.
</span><span class=c1></span><span class=n>st</span><span class=o>.</span><span class=na>setFetchSize</span><span class=o>(</span><span class=n>50</span><span class=o>);</span>
<span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=s>&#34;SELECT * FROM mytable&#34;</span><span class=o>);</span>
<span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>())</span>
<span class=o>{</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;a row was returned.&#34;</span><span class=o>);</span>
<span class=o>}</span>
<span class=n>rs</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>

<span class=c1>// Turn the cursor off.
</span><span class=c1></span><span class=n>st</span><span class=o>.</span><span class=na>setFetchSize</span><span class=o>(</span><span class=n>0</span><span class=o>);</span>
<span class=n>rs</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=s>&#34;SELECT * FROM mytable&#34;</span><span class=o>);</span>
<span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>())</span>
<span class=o>{</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;many rows were returned.&#34;</span><span class=o>);</span>
<span class=o>}</span>
<span class=n>rs</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>

<span class=c1>// Close the statement.
</span><span class=c1></span><span class=n>st</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</code></pre></div><br><div class=prev__next><p><a title="Next page in Configuring the Client" href=https://pgjdbc.github.io/pgjdbc/documentation/chapter4/ssl-client/>Configuring the Client | 11</a></p><p><a title="Previous page in Using the Statement or PreparedStatement Interface" href=https://pgjdbc.github.io/pgjdbc/documentation/chapter5/statement/>Using the Statement or PreparedStatement Interface | 13</a></p></div></article><aside></aside></div></main><footer class=footer><div class=footer__items><div class=footer__items__links><ul><li>Pgjdbc</li><li><a href=https://jdbc.postgresql.org/documentation/publicapi/index.html>Public API</a></li><li><a href=https://www.postgresql.org/>About PostgreSql</a></li></ul></div><div class=footer__items__links><ul><li>Community</li><li><a href=https://jdbc.postgresql.org/documentation/publicapi/index.html>Slack</a></li><li><a href=https://www.postgresql.org/>Twitter</a></li><li><a href=https://www.postgresql.org/>Mailing List</a></li></ul></div><div class=footer__items__links><ul><li>More</li><li><a href=https://jdbc.postgresql.org/documentation/publicapi/index.html>FAQ</a></li><li><a href=https://www.postgresql.org/>Privacy</a></li><li><a href=https://www.postgresql.org/>License</a></li></ul></div></div><p class=copyright>Copyright © 1996-2022 The PostgreSQL Global Development Group</p></footer></body></html>